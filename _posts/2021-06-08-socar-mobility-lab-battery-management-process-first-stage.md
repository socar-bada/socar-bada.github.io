# 자동차 시동 배터리를 잘 관리하기 위한 여정
안녕하세요

쏘카 모빌리티Lab의 Charlie(하철수) 입니다. 이 곳에서 처음 인사드립니다. 블로그에 글을 남기는게 처음이라 참 어색합니다. 그럼에도 만대가 넘는 차량을 운영하는 쏘카의 차량 관리에 어떤 기술이 어떻게 적용되는지 공유드리고자 용기내어 글을 남겨봅니다.

휘발유나 경유를 넣고 엔진(내연기관)을 돌려 구동하는 자동차는 우리가 아직까지 가장 쉽게 접할 수 있는자동차이자 탈것입니다. 1885년 벤츠의 가솔린 기관 자동차가 처음 세상에 나온 이래로 자동차의 발전 역사가 공학발전의 역사였고, 자연스럽게 자동차는 각 시대를 대표하는 기술이 모이는 하나의 플랫폼이 되었습니다. (조금 더설명 드리면,  유체역학,  물리학,  구조역학(기계공학에서 총괄함)을 기본으로 유기화학(철강,  유리,  자동차 시트,부품, 고무제품과 연관되며 화학공학에서 총괄함), 전기공학(센서, 카메라), 전자기학의 집합체가 자동차입니다.)결국, 자동차를 제대로 관리하기 위해선 역학적 요소에 대한 이해가 필요합니다.

쏘카의 모빌리티Lab은 모두 높은 수준의 기계공학지식을 보유한 인력으로 이루어졌으며, 쏘카의 차량을 풍부한차량데이터에 기계공학 기반의 인사이트를 녹여 운영에 필요한 최적 솔루션을 찾고 있습니다. (우리에게 힘을 더해주실 우수한 분을 모시고 있습니다. 언제든지 지원해주세요.)

모빌리티Lab을 대표하여 처음으로 다룰 주제는 기술 집합체인 자동차의 구동의 시작을 담당하는 자동차 배터리관리에 관한 이야기입니다. 경차에서 슈퍼카에 이르기까지 모든 내연기관 자동차는 시동을 걸어야 탈 것의 기능을 할수 있지요.  자동차에 장착된 시동용 배터리는 시동모터를 돌려 엔진을 구동시키는 역할을 합니다.  그런데 이배터리가 대단히 예민합니다. 사람처럼 추우면 힘을 못내고, 더우면 빨리 지치며, 제때 밥을 먹여주지 않으면 몸이곯아버립니다. 1만2천대가 넘는 차량을 운영하는 쏘카 입장에서는 하나 하나 살펴볼 수도 없고, 관리하기 여간 어려운게 아니지요.

그래도 공학자는 문제를 풀어내야 공학자이지요! 지금부터 쏘카는 어떻게 이 문제를 풀어가는지 최대한 쉽게 나누려고 합니다.

## 배터리 종합 관리
#### 1. 배경
- 방전과 관련된 문제는 월 100건 이상 접수됩니다.  어떤 경로로 접수되어 수리를 받는가에 따라다르지만 준중형차량(대표적으로 아반떼)  기준 수리비가  25만원까지 청구되기도 합니다.  방전문제는 회사의 관리 손실을 일으키는 중요 요소입니다.
- 개인이 관리하는 일반적인 차량의 경우 3년간 600~800회의 시동 시도가 기록되고 배터리 제조사의 보증 시동 횟수도 600~800회 정도 입니다. 그러나 쏘카가 운영하는 차량은 년간 2200~2800회 정도의 시동 시도가 발생합니다. 특히 2200회를 넘어가는 시점에서는 배터리 관련 고장으로 인해 공업사에 차량이 입고될 확률이 급격히 높아집니다. 그러므로 이 시기가 도래하기 전에 적절한 관리를 통해 배터리의 수명을 관리해주어야 합니다.

![](/img/socar-mobility-lab-battery-management-process-first-stage/Figure-1.png){: width="90%" height="90%" style="display: block; margin: 0 auto"}
<p align="center"> Figure 1 </p>

- 일부 고객의 배터리 사용 패턴에 따라 정상적 컨디션의 배터리가 방전되는 경우도 다수 존재합니다. 통계적으로 실제 방전 신고의 60%는 현 고객 혹은 직전 고객의 과실로 인한 문제였습니다.
- 차량에서 받을 수 있는 배터리 상태정보의 한계가 명확합니다. 별도의 정보 수집 장치가 없다면 시간, 전압, 시동상태 외에 차량에서 받을 수 있는 배터리 관련 정보는 없습니다.

#### 2. 문제 해결을 위한 접근 방법
- 현재 수집 가능하고 수년간 누적된 데이터 분석작업부터 시작
	- 물리적 정보: 전압, 신호 미 수신시간, 차량 별 생애 주기 동안 시동 횟수
	- 과거 운영 데이터: 실제 배터리 문제로 신고 접수된 건수 기록
- 배터리 관리 방법의 전환
	- 고객 신고가 들어오면 점프 혹은 배터리 교환을 했던 기존 프로세스의 전환
		- 배터리 상태가 어느정도 보존된 상태의 방전 초입의 배터리는 물리 화학적 관리를 거치면 배터리 수명을 연장 시킬 수 있습니다.
		<br>
		![](/img/socar-mobility-lab-battery-management-process-first-stage/Figure0_KOR.jpg){: width="70%" height="70%" style="display: block; margin: 0 auto"}
		<p align="center"> Figure 2 <br> </p>

		- 방전 초입을 어떻게 잡아내는가에 따라 관리 가능 여부가 갈립니다.
		- 방전 초입을 포착해도 이동, 회수, 배터리 관리, 재 장착 과정을 거치면서 발생하는 추가 관리 비용은 필연적이므로 선제적 관리가 기존 관리 방법에 비해 이득을 보장하는 영역을 찾아내는 알고리즘이 필요합니다.
	- 개발 당시 누적 데이터를 기준으로 배터리 방전여부를 판단하는 알고리즘 제작
		- 예약 직전의 모든 배터리 전압(V)과 단말 신호주기(dt)를 추출하여 배터리 방전 신고 확률을 구합니다. 이때, 신고가 올 확률이 임계 확률보다 높아지면 사전 정비를 통해 이득을 얻을 수 있습니다. 이 임계 확률 구하기가 결국 과제의 중요 목표 중 하나입니다.
		- 연구 과정 (순서대로)
			- 개발 시작 시점까지의 모든 고객과 쏘팸 예약 내역 추출
			- 예약 점유시간동안 배터리 관련 신고가 없고, 시동이 한번이라도 켜진 예약 리스트를 추출
			- 예약 점유시간동안 배터리 관련 신고가 있는 예약 리스트 추출
			- 위의 두 리스트의 배터리 전압과, 신호가 들어오지 않는 시간 간격을 추출 <br>
			
			![](/img/socar-mobility-lab-battery-management-process-first-stage/Figure1_KOR.png){: width="90%" height="90%" style="display: block; margin: 0 auto"}
			<p align="center"> Figure 3 <br> </p>
		  
			- DB 조회를 통해 배터리 관련 총 신고 건수, 배터리 관련 긴급출동 데이터, 정비 비용, 관리 중 발생하는 이동거리에 기반한 물류비를 모두 반영한 기준을 수립
			- 위의 Figure 3 기준을 따라 배터리 신고가 들어오는 비율을 2D Contour로 나타냄 (Figure 4) <br>
			![](/img/socar-mobility-lab-battery-management-process-first-stage/Figure2.png){: width="90%" height="90%" style="display: block; margin: 0 auto"}
			<p align="center"> Figure 4 </p>
	
			- 서울 경인과 그 외 지역의 관리 비용 차이로 인해 Contour가 조금 달라질 수 있어서 아래와 같이 분리해서 추출했고, 정상 배터리 전압영역 (12.4V) 이하를 이상영역으로 명확히 보면 아래와 같음. 위의 Contour와 다르게 아래는 확률 분포가 무시된 Binary Contour임 (Figure 5, 6)
			![](/img/socar-mobility-lab-battery-management-process-first-stage/Figure3.png){: width="90%" height="90%" style="display: block; margin: 0 auto"}
			<p align="center"> Figure 5 </p>
			![](/img/socar-mobility-lab-battery-management-process-first-stage/Figure4.png){: width="90%" height="90%" style="display: block; margin: 0 auto"}
			<p align="center"> Figure 6 </p>
		  
			- Binary Contour는 아래의 수식(Figure 7)을 기초로 하며, 운영 데이터를 통해 구해진 합리적 수치보다 Precision이 큰 영역을 Highlight 하여 만들어짐
			![](/img/socar-mobility-lab-battery-management-process-first-stage/Figure5.png){: width="90%" height="90%" style="display: block; margin: 0 auto"}
			<p align="center"> Figure 7 </p>

			- 샘플로 추출된 특정 기간동안 데이터를 바탕으로 Confusion Matrix를 계산하면 아래와 같음. 단, 113대 중 일부는 과잉정비가 아닐 수 있고 그 값을 정확히 알 수 없어 alpha 로 두었음
			![](/img/socar-mobility-lab-battery-management-process-first-stage/Figure6_KOR.png){: width="90%" height="90%" style="display: block; margin: 0 auto"}
			<p align="center"> Figure 8 </p>
		  	
			- Contour를 바탕으로 실시간으로 차량 상태를 조회하여 전압과 dt가 Contour에 올라온다면 방전으로 판단하고 적절한 조치를 취함
		
	- 방전 의심 차량의 관리 방법
		- 전기 화학적 관리 방법
			- 자동차 시동용 배터리나 지게차 배터리로 널리 사용되는 납산전지는 이차전지의 한 종류입니다.  완전히 충전된 상태에서 음극판은 완전한 납으로만 구성되어 있고, 양극판은 이산화납으로 구성되어 있습니다. 전해액은 고농도의 황산인데 화학적 에너지를 가득 품고 있습니다. 시간이 지남에 따라 음극판이 고농도의 황산과 반응하여 황산납과 2개의 전자를 방출합니다. 이 전자들이 도선을 따라 흐르다가 양극에 만나면 환원 반응을 하게 됩니다. 자동차 시동용 납축전지는 일시에 과대전류를 뿜어내는데 최적화 되어있으므로 완전 충전 후 일시에 큰 전류를 소량 사용(임펄스 전류), 이후에는 바로 완전충전해 사용하는 방식에 최적화 되어있습니다. 그러므로 충전하지 않고 전지를 계속 사용하면 쉽게 고장납니다. 예를 들면, 용량의 50%를 사용하고 일주일을 충전하지 않으면 후에 충전을 한다 하더라도 이미 사용한 50%에 대한 회복은 어렵습니다. 따라서 시동용 납축전지를 보통의 충전지처럼 사용하면 수 회 사용으로 완전히 고장납니다. 자동차 시동용 배터리로 가장 널리 사용되는 밀폐형 혹은 무보수형(MF)으로 불리는 납축전지의 경우 정상적 사용조건 아래에서 3년 500회의 시동횟수를 커버할 수 있습니다. 그 이상 사용하기 어려운 이유는 시간이 지남에 따라 자연적 화학반응에 의해 음극판에도 황화납이 침착 되어 이온교환이 원활하게 이루어지지 않기 때문입니다. 평소 충전을 자주 해주어 전류를 일정 수준 이하로 떨어지지 않게 유지하면 오래 쓸 수 있으나, 반대로 너무 오래 방전을 해서 한 번이라도 충전 한계 전압 이하로 떨어지게 되면(심방전이라고 함) 그 땐 이미 극판에 황화납 피막이 두껍게 형성된 상태라 재 충전이 거의 안되며 배터리를 폐기해야 합니다.
			- 납산전지의 약점 중 하나는 온도 변화에 성능 변화가 크게 좌우된다는 점입니다. 섭씨 0도의 배터리는 섭씨 25도의 배터리의 63%성능만을 발휘하는데 섭씨 0도에서 엔진이 시동을 위해 필요로 하는 외력은 섭씨 25도의 엔진이 요구하는 외력의 165%에 육박합니다. 따라서 납산전지를 시동용으로 사용하는 자동차는 겨울철에 시동이 잘 걸리지 않는 고질적 문제를 안고 있습니다.
			- 위에서 언급한바와 같이 일단 심방전이 일어나면 극판에 황화납 피막이 높은 수준으로 형성됩니다. 그러나 초기 심방전이나, 심방전의 횟수가 2회 미만인 배터리의 경우 고주파 펄스 형태로 전류를 배터리에 보내면 극판에 진동을 일으켜 황화납을 어느정도 탈각시킬 수 있습니다. 즉 초기 심방전이나, 심방전으로 이를 가능성이 매우 높은 배터리를 조기에 발견하여 조치하면 배터리의 수명연장이 어느정도 가능합니다. 혹은 배터리에 대한 이해가 높고 충분한 장비가 있다면 배터리의 극판의 황화납을 물리적으로 탈각시키는 방법을 시도하여 배터리 수명을 유지시킬 수 있습니다. 이러한 방법을 Reconditioning (재건조화) 라고 합니다.
		- 실제 관리 POC의 진행
			- 초기 FS ~ 1차 POC 기간간 직접 Reconditioning 수행 
				- 전국단위의 FS 및 1차 POC를 수행하려면 전국에 본사의 LAB 환경과 동일한 관리 시설을 두어야합니다. 초기 검증기간에 전국 인프라 구축은 현실적으로 어렵기 때문에 LAB에서 커버가능한 서울과 그 주변 도시들을 타깃으로 했습니다.
				- 위에서 설명한 배터리 관리 필요 대상 차량을 자동으로 추출하는 시스템에서 서울 경기 차량 중 관리가 필요한 차량을 일~목 동안 선정하여 Reconditioning을 수행했습니다.
				- 초기 방전 및 AGM배터리의 경우 90% 이상의 회복을 보여주었습니다 (Reconditioning 이후 6개월 이상 재인입이 없는 차량 기준). 그러나 심방전이 지속된 차량의 배터리나 일반 MF형 배터리의 경우 30% 대의 회복을 보여주어서 조기 발견 및 대응이 중요함을 확인했습니다.
				- 이 프로세스가 쏘카의 차량 대다수에 가장 널리 사용되는 AGM 배터리의 Reconditioning에 잘 맞고 이익을 줄 수 있음을 확인했습니다. 경형 차량에 주로 사용되는 MF형 배터리는 시중에 판매되는 Reconditioning 장비로 황산납 탈각이 잘 안됨을 보았습니다. MF형 배터리에 대해 Reconditioning 기술을 보유하고 있는 소수의 기업이 있으며 그 중 일부 기업은 합리적인 가격으로 서비스를 제공합니다.
				- 배터리 문제로 인해 신고가 들어온 차량의 60%는 고객의 차량 사용 미숙이 주된 원인이었습니다. 고객께서 차량 사용에 문제가 없도록 가이드를 잘 한다면 방전의 60%를 해결 가능하다는 말로도 이해가 가능한 부분입니다. 따라서 배터리 방전을 일으키기 쉬운 상황이 감지되면 고객님께 적절한 알림을 드리는 시스템을 구축하기로 했습니다.
			- 2차 POC 혹은 전면 도입 기간에 대량 관리를 위한 Reconditioning 및 관리 시스템 구축

## 맺으며
이번에 소개드린 쏘카의 배터리 관리 프로세스는 데이터와 기술이 어떻게 결합되어 어떤 솔루션을 줄 수 있는지를 보여주는 좋은 예시라고 생각됩니다. 여기서 소개했던 배터리 관리 프로세스 이외에도 현재 쏘카에서는 운영상 발생하는 다양한 문제에 대해 데이터와 기술을 결합하여 좋은 솔루션을 도출하고 그 솔루션을 기반으로 운영 문제를 해결하는 시도를 하고 있습니다. 앞으로도 다양한 사례들에 대해 하나씩 이야기를 풀어 나가려고 하니 기대해주세요.
그럼 저는 이만 인사드리며 물러나도록 하겠습니다.
				